
radarBlips = --- name : name,blip element,type,image,r,g,b
{
	["cityhall"]={"Városháza",createBlip (2265.6796875, -77.095916748047, 26.78125,0,2,255,0,0,255,0,0),0,"city_hall",32,32,255,255,255},
	["bank"]={"Bank",createBlip (2312.0461425781, -13.882838249207, 26.7421875,0,2,255,0,0,255,0,0),0,"bank",24,24,255,255,255},
	["boatshop"]={"Hajókereskedés",createBlip (2158.1137695312, -104.41160583496, 1.55,0,2,255,0,0,255,0,0),0,"boat_shop",24,24,255,255,255},
	["carshop"]={"Autószalon",createBlip (1378.6837158203, 403.34411621094, 28.755516052246,0,2,255,0,0,255,0,0),0,"car_shop",24,24,255, 255, 255},
	["fishing1"]={"Horgászat (Leadó)",createBlip (2136.560546875, -88.160049438477, 2.8697571754456,0,2,255,0,0,255,0,0),0,"fishing",24,24,255,255,255},
	["fishing2"]={"Horgászat (Leadó)",createBlip (1426.3779296875, -285.89874267578, 1.4241695404053,0,2,255,0,0,255,0,0),0,"fishing",24,24,255,255,255},
	["gas_station_1"]={"Benzinkút",createBlip (1382.9619140625, 465.33905029297, 24.145202636719,0,2,255,0,0,255,0,0),0,"gas_station",24,24,255, 255, 255},
	["gas_station_2"]={"Benzinkút",createBlip (653.63507080078, -570.09442138672, 16.3359375,0,2,255,0,0,255,0,0),0,"gas_station",24,24,255, 255, 255},
	["gas_station_3"]={"Benzinkút",createBlip (257.873046875, -24.236043930054, 16.285961151123,0,2,255,0,0,255,0,0),0,"gas_station",24,24,255, 255, 255},
	["hospital"]={"Kórház",createBlip (1245.6650390625, 325.83975219727, 30.65625,0,2,255,0,0,255,0,0),0,"hospital",24,24,255,255,255},
	["sheriff"]={"Sheriffség",createBlip (631.87451171875, -562.94104003906, 18.0,0,2,255,0,0,255,0,0),0,"sheriff_hq",24,24,255, 255, 255},
	["binco1"]={"Ruhabolt",createBlip (1294.9460449219, 288.36050415039, 19.5546875,0,2,255,0,0,255,0,0),0,"clothes_shop",24,24,255,255,255},
	["binco2"]={"Ruhabolt",createBlip (691.36291503906, -621.47973632812, 16.3359375,0,2,255,0,0,255,0,0),0,"clothes_shop",24,24,255,255,255},
	["binco3"]={"Ruhabolt",createBlip (142.45780944824, -180.97970581055, 1.578125,0,2,255,0,0,255,0,0),0,"clothes_shop",24,24,255,255,255},
	["Ammu-Nation1"]={"Lőtér",createBlip (2333.1171875, 61.561214447021, 26.70578956604,0,2,255,0,0,255,0,0),0,"weapon_shop",24,24,255,255,255},
	["Ammu-Nation2"]={"Lőtér",createBlip (243.2919921875, -178.31414794922, 1.5821628570557,0,2,255,0,0,255,0,0),0,"weapon_shop",24,24,255,255,255},
	["hunter1"]={"Vadászati terület",createBlip (-514.07745361328, -88.655632019043, 129.5859375,0,2,255,0,0,255,0,0),0,"hunting_ground",32,32,255,255,255},
	["hunter2"]={"Vadászati terület",createBlip (958.14831542969, -8.8659687042236, 185.5859375,0,2,255,0,0,255,0,0),0,"hunting_ground",32,32,255,255,255},
	["hunter3"]={"Vadászati terület",createBlip (167.66149902344, -545.16827392578, 114.46670532227,0,2,255,0,0,255,0,0),0,"hunting_ground",32,32,255,255,255},
	["shop1"]={"Vegyes Bolt",createBlip (251.99401855469, -56.837478637695, 1.5703125,0,2,255,0,0,255,0,0),0,"shop",24,24,255,255,255},
	["carrent1"]={"Autóbérlő",createBlip (707.28759765625, -473.96951293945, 18.498977661133,0,2,255,0,0,255,0,0),0,"rent",24,24,255,255,255},
	["bikerent1"]={"Biciklibérlő",createBlip (2214.8024902344, -108.00592041016, 26.484375,0,2,255,0,0,255,0,0),0,"bikerent",24,24,255,255,255},
	["pizza1"]={"Pizzázó",createBlip (1365.7856445312, 242.50621032715, 29.498977661133,0,2,255,0,0,255,0,0),0,"pizza",24,24,255,255,255},
	['racetrack'] = {'Versenypálya', createBlip (433.94812011719, 598.49359130859, 21, 0, 2, 255, 0, 0, 255, 0, 0), 0, 'racingtrack', 24, 24, 255, 255, 255},
	['driving_license'] = {'Oktató Központ', createBlip (2246.8137207031, 28.373165130615, 27.44687461853, 0, 2, 255, 0, 0, 255, 0, 0), 0, 'driver', 24, 24, 255, 255, 255},
	['furniture_shop'] = {'Bútorbolt', createBlip (2302.4636230469, 56.256633758545, 26.484375, 0, 2, 255, 0, 0, 255, 0, 0), 0, 'furniture_shop', 24, 24, 255, 255, 255},
	["hotdog"]={"Dog House",createBlip (622.04113769531, -494.84857177734, 26.5,0,2,255,0,0,255,0,0),0,"hotdog",24,24,255,255,255},
	["casino"]={"Kaszinó",createBlip (2272.8381347656, 79.229835510254, 32.296875,0,2,255,0,0,255,0,0),0,"casinoNew",24,24,255,255,255},
	["car_repair"]={"Szerelőtelep",createBlip (217.30953979492, -244.75373840332, 3.0184392929077,0,2,255,0,0,255,0,0),0,"car_repair",24,24,255,255,255},
	["hobby1"]={"Hobbi Bolt",createBlip (248.52159118652, -57.612331390381, 5.8828125,0,2,255,0,0,255,0,0),0,"hobby",24,24,255,255,255},
	["hobby2"]={"Hobbi Bolt",createBlip (2318.6550292969, -89.321273803711, 26.484375,0,2,255,0,0,255,0,0),0,"hobby",24,24,255,255,255},
}

radarOwnBlips = {}


local free_ids = {}
local free_id = 1
function createOwnBlip(type,word_x,word_y)
	local name = ""
	if type == "mark_1" or type == "mark_2" or type == "mark_3" or type == "mark_4" then name = "Jelölés"
	elseif type == "garage" then name = "Garázs"
	elseif type == "house" then name = "Ház"
	elseif type == "vehicle" then name = "Jármű" end
    if not free_ids[type] then
        free_ids[type] = 0
    end
    local free_id = free_ids[type] + 1
	if not radarOwnBlips[name.." "..tostring(free_id)] then
		local element = createBlip (word_x,word_y,0,0,2,255,0,0,255,0,0)
		radarOwnBlips[name.." "..tostring(free_id)] = {name.." "..tostring(free_id),word_x,word_y,0,type,12,12,255,255,255}
		createStayBlip(name.." "..tostring(free_id),element,0,type,12,12,255,255,255)
		free_ids[type] = 1 
	else
		free_ids[type] = free_id+1
		createOwnBlip(type,word_x,word_y)
	end
end

function deleteOwnBlip(name)
	if radarOwnBlips[name] then
		destroyStayBlip(name)
		radarOwnBlips[name] = nil
	end
end

function jsonLoad()
	local json = fileOpen(":cr_radar/blips.json")
	local json_string = ""
	while not fileIsEOF(json) do
		json_string = json_string..""..fileRead(json,500)
	end
	fileClose(json)
	return fromJSON(json_string)
end

function jsonSave()
	if fileExists(":cr_radar/blips.json") then fileDelete(":cr_radar/blips.json") end
	local json = fileCreate(":cr_radar/blips.json")
		local json_string = toJSON(radarOwnBlips)
		fileWrite(json,json_string)
		fileClose(json)
end

addEventHandler( "onClientResourceStart",resourceRoot,function()
	if fileExists(":cr_radar/blips.json") then

		local blip_table = nil
		local json = fileOpen(":cr_radar/blips.json")
		local json_string = ""
		while not fileIsEOF(json) do
			json_string = json_string..""..fileRead(json,500)
		end
		fileClose(json)
		blip_table = fromJSON( json_string )
		for k, values in pairs(blip_table) do
			radarOwnBlips[values[1]] = {values[1],values[2],values[3],values[4],values[5],values[6],values[7],values[8],values[9],values[10]}
			createStayBlip(values[1],createBlip (values[2],values[3],0,0,2,255,0,0,255,0,0),values[4],values[5],values[6],values[7],values[8],values[9],values[10])
		end
	end
end)

addEventHandler( "onClientResourceStop",resourceRoot,function()
	 jsonSave()
end)



function createStayBlip(name,element,visible,image,imgw,imgh,imgr,imgg,imgb,no3d)
    radarBlips[name] = {name,element,visible,image,imgw,imgh,imgr,imgg,imgb,no3d}
end


function destroyStayBlip(name)
	radarBlips[name] = nil
end
